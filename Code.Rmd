---
title: "Proj 2"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

* Import data
```{r}
image1 = read.delim(file = "image_data/image1.txt", header = FALSE, sep = "")
colnames(image1) = c("y_coord", "x_coord", "expert_label", "NDAI", "SD", "CORR", "DF", "CF", "BF", "AF", "AN")
image2 = read.delim(file = "image_data/image2.txt", header = FALSE, sep = "")
colnames(image2) = c("y_coord", "x_coord", "expert_label", "NDAI", "SD", "CORR", "DF", "CF", "BF", "AF", "AN")
image3 = read.delim(file = "image_data/image3.txt", header = FALSE, sep = "")
colnames(image3) = c("y_coord", "x_coord", "expert_label", "NDAI", "SD", "CORR", "DF", "CF", "BF", "AF", "AN")
all = rbind(image1, image2, image3)
```


* 1(b)
```{r}
nrow(image1)
sum(image1$expert_label == 1) / nrow(image1)
sum(image1$expert_label == -1) / nrow(image1)
sum(image1$expert_label == 0) / nrow(image1)
```
For image1, there are 115229 data points. We calculate % of pixels for the different classes: 17.77% classified as cloud, 43.78% as not cloud and 38.46% as unlabeled.
```{r}
nrow(image2)
sum(image2$expert_label == 1) / nrow(image2)
sum(image2$expert_label == -1) / nrow(image2)
sum(image2$expert_label == 0) / nrow(image2)
```
For image2, there are 115110 data points. We calculate % of pixels for the different classes: 34.11% classified as cloud, 37.25% as not cloud and 28.64% as unlabeled.
```{r}
nrow(image3)
sum(image3$expert_label == 1) / nrow(image3)
sum(image3$expert_label == -1) / nrow(image3)
sum(image3$expert_label == 0) / nrow(image3)
```
For image3, there are 115217 data points. We calculate % of pixels for the different classes: 18.44% classified as cloud, 29.29% as not cloud and 52.27% as unlabeled.
```{r}
nrow(all)
sum(all$expert_label == 1) / nrow(all)
sum(all$expert_label == -1) / nrow(all)
sum(all$expert_label == 0) / nrow(all)
```
After we combined three image data sets, there are 345556 data points. We calculate % of pixels for the different classes: 23.43% classified as cloud, 36.78% as not cloud and 39.79% as unlabeled.

```{r}
library(ggplot2)
label = image1$expert_label
label[label == 1] = "cloud"
label[label == -1] = "not cloud"
label[label == 0] = "unlabeled"
image1_plot = data.frame(x = image1$x_coord, y = image1$y_coord, label = label)
ggplot(data = image1_plot,aes(x = x, y = -y, color = label)) + geom_point() + scale_color_manual(values=c("white", "grey", "black"))
```

```{r}
label = image2$expert_label
label[label == 1] = "cloud"
label[label == -1] = "not cloud"
label[label == 0] = "unlabeled"
image2_plot = data.frame(x = image2$x_coord, y = image2$y_coord, label = label)
ggplot(data = image2_plot,aes(x = x, y = -y, color = label)) + geom_point() + scale_color_manual(values=c("white", "grey", "black"))
```
```{r}
label = image3$expert_label
label[label == 1] = "cloud"
label[label == -1] = "not cloud"
label[label == 0] = "unlabeled"
image3_plot = data.frame(x = image3$x_coord, y = image3$y_coord, label = label)
ggplot(data = image3_plot,aes(x = x, y = -y, color = label)) + geom_point() + scale_color_manual(values=c("white", "grey", "black"))
```
From the three plots, we can see the pattern that the pixels with same labels are connected to each other, and unmarked pixels stay around those marked as clouds. This pattern contradicts to our assumption that the samples are i.i.d., because the pixels adjcent to pixels marked as clouds are more likely to be marked as clouds.

* (c)
```{r}
# pairwise relationship between features for image1
features = data.frame(NDAI = image1$NDAI, SD = image1$SD, CORR = image1$CORR, DF = image1$DF, CF = image1$CF, BF = image1$BF, AF = image1$AF, AN = image1$AN)
pairs(features, gap = 0, pch = ".")
```
```{r}
# pairwise relationship between features for image3
features = data.frame(NDAI = image2$NDAI, SD = image2$SD, CORR = image2$CORR, DF = image2$DF, CF = image2$CF, BF = image2$BF, AF = image2$AF, AN = image2$AN)
pairs(features, gap = 0, pch = ".")
```
```{r}
# pairwise relationship between features for image3
features = data.frame(NDAI = image3$NDAI, SD = image3$SD, CORR = image3$CORR, DF = image3$DF, CF = image3$CF, BF = image3$BF, AF = image3$AF, AN = image3$AN)
pairs(features, gap = 0, pch = ".")
```
The three pairwise scatterplots all show that DF, CF, BF, AF and AN shows a linear relationship between each other, especially for AF and AN, AF and BF. However, we observe that data points in the third pairwise scatterplot spread more widely than in the first two pairwise sctterplots. The differences between three graphs can also show that the (linear) relationships decrease over time.

```{r}
#relationship between expert label and NDAI image1
expert_NDAI = data.frame(label = as.character(image1$expert_label), CORR = image1$CORR)
expert_NDAI = expert_NDAI[which(expert_NDAI$label != "0"), ]
ggplot(data = expert_NDAI, aes(x = label, y = CORR, group = label, fill = label)) + geom_boxplot() + scale_fill_discrete(name = "Label", labels = c("not cloud", "cloud")) + ggtitle("Label vs. CORR image1")
```

```{r}
#relationship between expert label and NDAI image2
expert_NDAI = data.frame(label =  as.character(image2$expert_label), CORR = image2$CORR)
expert_NDAI = expert_NDAI[which(expert_NDAI$label != "0"), ]
ggplot(data = expert_NDAI, aes(x = label, y = CORR, group = label, fill = label)) + geom_boxplot() + scale_fill_discrete(name = "Label", labels = c("not cloud", "cloud")) + ggtitle("Label vs. CORR image2")
```
```{r}
#relationship between expert label and NDAI image2
expert_NDAI = data.frame(label =  as.character(image3$expert_label), CORR = image3$CORR)
expert_NDAI = expert_NDAI[which(expert_NDAI$label != "0"), ]
ggplot(data = expert_NDAI, aes(x = label, y = CORR, group = label, fill = label)) + geom_boxplot() + scale_fill_discrete(name = "Label", labels = c("not cloud", "cloud")) + ggtitle("Label vs. CORR image3")
```
```{r}
#relationship between expert label and NDAI image2
expert_NDAI = data.frame(label =  as.character(all$expert_label), CORR = all$CORR)
expert_NDAI = expert_NDAI[which(expert_NDAI$label != "0"), ]
ggplot(data = expert_NDAI, aes(x = label, y = CORR, group = label, fill = label)) + geom_boxplot() + scale_fill_discrete(name = "Label", labels = c("not cloud", "cloud")) + ggtitle("Label vs. CORR All Data")
```
The boxplots for CORR based on different labels show that CORR is on average higher for pixels marked as cloud than as not cloud. CORR also has a higher variance for those marked as cloud.
This conclusion contradicts to the statement in the paper that high correlations over cloud-free areas or low clouds are expected. This is because high correlations for clouds also occur under rare circumstances. More importantly, recklessly declare clear for high CORR

Therefore, we also 